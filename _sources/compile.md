# よくわからないプログラムなんか使えないよ！

どこの馬の骨とも知れぬ輩が配っている.exeなんか実行できないよ！という慎重でセキュリティ意識の高いあなたへ。

自力でソースコードの安全性を確認した上でコンパイルしましょう。

## コンパイル方法

[.NET 6.0](https://dotnet.microsoft.com/download/dotnet/6.0)
をインストールして
cmd.exe
で
cd .\MultiBouyomiSelector
から
dotnet build
すると
.\MultiBouyomiSelector\Output
に配布zipと同じ物ができます。

詳しくはMultiBouyomiSelector.csprojとzipping.ps1を読んでください。

## ざっくりとした仕組み

MultiCommentViewerは全てのコメントをBouyomiChanチャンネルに投げてきます。
それらのコメントを

- 古いものは捨てつつ新しいものをいくつか保存しておく
    - タイミングによっては読まれずに捨てられる
- 棒読みちゃんが読み上げ最中でなければ保存されているコメントを古い順に投げる

という手順で捌いています。

MultiCommentViewerや棒読みちゃんとやり取りするために、同じ方法（dotnet-ipcとでも呼ぶべき方式）で通信しています。

あとは手間を減らすために、MultiBouyomiSelectorの起動・終了とともに棒読みちゃんも起動・終了しています。
このために
settings.xml
に記載されている棒読みちゃんのプロセスを探したりします。

PC外と通信したり、徒にファイルを書き換えたりはしません。

## しっかり説明

しようと思いましたが、とくに説明することはありませんでした。

BouyomiChanServerのReceiveTextとSendTextが全てです。
あとはGUIとかIPCチャンネル取得とか棒読みちゃんの開始・終了とかにまつわる些事です。

いくつか命名センスを疑うような名前がついているものがあります。
何に使われているのか確認しておかないと誤解するかも知れません。

設定を間違えたりプログラムの中身を弄ったりしない限り、使用者が予想していない挙動を起こすことは難しいと思います。
…多分。
